function checkForm(e){var r=$(e),o=r.attr("id"),a="",s=r.val();switch("phone"==o&&(s=$("#zone").val().concat(s)),o){case"phone":a=domObj.reg.test(s)?"":"手机号格式有误";break;case"password":a=domObj.pwd(s)?"":"密码格式不正确或太简单";break;case"code":a=""!=s?4==s.length?"":"验证码格式不正确":"验证码必填";break;case"address":a=""!=s?"":"省市区必填"}""!=a?"手机号格式有误"==a?r.parent().removeClass("reg-bc").addClass("reg-border").addClass("error"):r.removeClass("reg-bc").addClass("reg-border").addClass("error"):"phone"==o?r.parent().addClass("reg-bc").removeClass("error"):r.addClass("reg-bc").removeClass("error"),formCheck()}function formCheck(){var e=!0;$(" #code, #password, #address,#reg-num-wrap").each(function(r,o){return $(o).hasClass("error")?(e=!1,!1):void 0}),e?formEnable():formDisabled()}function formDisabled(){$("#formSubmit").addClass("disabled")}function formEnable(){$("#formSubmit").removeClass("disabled")}var time;$("#getCode").on("click",function(){var e=$("#phone").val(),r=$("#zone").val(),o="";o=r.concat(e);var a=$("#getCode");return a.hasClass("coding")||(domObj.reg.test(o)?(a.addClass("coding"),wmTools.ajaxPost("/api3/getPhoneCode",{phone:e,codeTo:"register",zone:r},function(e){0==e.errcode?(a.val(domObj.time--+"s"),time=setInterval(function(){a.val(domObj.time--+"s"),-1==domObj.time&&(clearInterval(time),domObj.time=60,a.val("获取验证码").removeClass("coding"))},1e3)):(wmTools.tips(e.errmsg),a.removeClass("coding"))})):wmTools.tips("手机号有误")),!1}),$(".js-protocol-o").on("click",function(){var e=$(".register-cont-wrap").width();return $(".js-protocol").show(),$(".reg-details-wrap").css({"margin-left":-e}),!1}),$(".js-protocol-btn").on("click",function(){return $(".js-protocol-xcx").show(),bodyModel.open(),!1}),$(".js-protocol-xcx").on("click",function(){return $(".js-protocol-xcx").hide(),bodyModel.close(),!1}),$(".js-back").on("click",function(){$(".reg-details-wrap").css({"margin-left":0})}),$("#phone, #code, #password").on("blur",function(){checkForm(this)}),$("#phone, #code, #password").on("focus",function(){var e=$(this),r=e.attr("id");"phone"==r?e.parent().removeClass("error").removeClass("reg-bc").addClass("reg-border"):e.removeClass("error").removeClass("reg-bc").addClass("reg-border")}),$(document).on("reset","#regForm",function(){$("#phone, #code, #password").each(function(e,r){var o=$(r),a=o.attr("id");"phone"==a?o.parent().removeClass("error").addClass("reg-bc"):o.removeClass("error").addClass("reg-bc")}),$(".reg-details-wrap").css({"margin-left":0}),formEnable()}),$("#formSubmit").on("click",function(){if(!$("#formSubmit").hasClass("disabled")){var e=$("#zone").val(),r=$("#regForm").serialize(),o=$("#phone").val(),a=$("#code").val(),s=$("#password").val(),t=$("#address").val(),n="";if(n=e.concat(o),!domObj.reg.test(n))return wmTools.tips("手机号有误"),!1;if(""==a)return wmTools.tips("验证码必填"),!1;if(!domObj.pwd(s))return wmTools.tips("密码格式不正确或太简单"),!1;if(!t)return wmTools.tips("省市区必填"),!1;$("#formSubmit").addClass("disabled"),wmTools.ajaxPost("/api3/ac/register",r,function(e){if(0==e.errcode){var r={pagename:wmDot.getPageName(),elementid:"register",eventtype:"tap",wid:e.data};wmDot.sendDot(r);var o=$("#wmreg").data("domain");window.location.href=o+"/success"}else{var r={pagename:wmDot.getPageName(),elementid:"register",eventtype:"tap"};wmDot.sendDot(r),wmTools.tips(e.errmsg)}$("#formSubmit").removeClass("disabled")})}}),$(function(){var e=new wmArea;e.init({trigger:".js-area-trg",data:areaData,callback:function(e){e&&($("#province").val(e.codes[0]),$("#city").val(e.codes[1]),$("#region").val(e.codes[2])),checkForm($("#address")[0])}}),$.post("/api3/bc/getLocationByIp",function(r){var o=[0,0,0];if(r&&0==r.errcode&&r.data&&""==$("#province").val()){var a=r.data;o=[a.province,a.city,a.area],e.setValues(o),$("#province").val(o[0]),$("#city").val(o[1]),$("#region").val(o[2]),$("#address").val(a.provinceStr+(a.cityStr?"/"+a.cityStr:"")+(a.areaStr?"/"+a.areaStr:""))}})});